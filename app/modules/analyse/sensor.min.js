"use strict";angular.module("app").component("sensor",{templateUrl:"app/modules/analyse/sensor.html?rev=4c798026c6",bindings:{resolve:"<",close:"&",dismiss:"&",parent:"<",treeDataFrom:"="},controller:["$api","$uibModal","$stateParams","$rootScope","$scope",function(a,e,n,t,i){var c=this,r=t.Project[0]._id;c.haveData=!0,c.currentPage=1,c.popPageSize=10,c.devicetype=[{id:void 0,name:"全部类型"}],a.device.type({project:r},function(e){angular.forEach(e.result,function(e){c.devicetype[e.id]=e,c.devicetype.push(e)})}),c.sensorApi=function(){a.customer.info({project:r},function(e){console.log(e)}),a.sensor.info({project:r,key:c.sensorSearchKey,devicetype:c.devicetype.selected,pageindex:c.currentPage,SHOWALL:!0},function(e){c.listData=[],c.allListData=[];for(var t={},a=0;a<e.result.detail.length;a++){switch((t={}).addrid=e.result.detail[a].addrid,t.title=e.result.detail[a].title,t.enable=!1,t.index=a,e.result.detail[a].devicetype){case"ULTRACOLDWATERMETER":t.devicetype="超声波水表";break;case"PRESSUREMETER":t.devicetype="压力表";break;case"MELECTRICITYMETER":t.devicetype="多功能电表";break;case"COLDWATERMETER":t.devicetype="冷水表";break;case"TEMPHUMMETER":t.devicetype="温湿度表";break;case"ELECTRICITYMETER":t.devicetype="电表";break;default:t.devicetype="其他"}c.allListData.push(t),console.log("push Suc")}e.result.detail.length?c.haveData=!0:c.haveData=!1,i.$watch("$ctrl.currentPage",function(){c.listData=[];var e=0;e=10*c.currentPage>c.allListData.length?c.allListData.length:10*c.currentPage;for(var t=10*c.currentPage-10;t<e;t++)c.listData.push(c.allListData[t])})})},i.$watch("$ctrl.devicetype.selected",function(){c.sensorApi()}),c.UpdateViewOfSensors=function(e){c.sensorApi()},c.check=function(e){e.enable=!e.enable},c.SelectAll=function(){angular.forEach(c.allListData,function(e,t){e.enable=!0})},c.AntiElection=function(){angular.forEach(c.allListData,function(e,t){e.enable=!1})},c.Ok=function(){angular.forEach(c.allListData,function(e,t){e.enable&&a.eca.update({projectid:r,method:"ADD",node:{title:e.title,type:n.datatype||"BYITEM",enable:!0,parent:c.parent.id}},function(e){c.dataUp(),$("#sensor").modal("hide")})})},c.dataUp=function(){a.eca.info({projectid:t.Project[0]._id,type:n.datatype||"BYITEM"},function(e){c.treeDataFrom=e.result})}}]});