angular.module("app").component("dashboard",{templateUrl:"app/modules/dashboard/dashboard.html?rev=9a2739fbe6",controller:["$rootScope","$scope","$state","$interval","$api","User","$uibModal","SweetAlert",function(r,e,i,s,t,n,a,o){console.log(r);var c=this,u=function(){t.weather.recent({projectid:r.Project.current._id},function(e){e=e.result;r.weather=c.weather=e.weather,r.humidity=c.humidity=e.humidity,r.temperature=c.temperature=e.temperature,r.wind_direction=c.wind_direction=e.wind_direction,r.wind_power=c.wind_power=e.wind_power,r.aqi=c.aqi=e.aqi,r.pm25=c.pm25=e.pm25})},l=s(function(){u()},36e5);console.log(i.current.url),c.uid=r.User.data.uid,"/system"==i.current.url?(r.shownav=c.shownav=!1,c.dashboard=!0):"/chosen"==i.current.url?r.shownav=c.shownav=!1:"/main"==i.current.url?(c.main=!0,r.shownav=c.shownav=!1,c.dashboard=!0):(c.main=!1,r.shownav=c.shownav=!0,c.dashboard=!1),u(),c.menuData=r.menuData,c.more=[{key:"ALL",title:" 全部"},{key:"HOTWATERMETER",title:"电"},{key:"TEMPERATURECONTROL",title:"水"},{key:"TTYPETEMPCONTROL",title:"冷热量"},{key:"DDWATERMETER",title:"费用"}],c.analyseTime=[{title:"今日",key:"today"},{title:"本月",key:"month"},{title:"本年",key:"year"}],c.dblclick=function(){r.shownav=c.shownav=!c.shownav,function(){var e=document.documentElement,t=e.requestFullScreen||e.webkitRequestFullScreen||e.mozRequestFullScreen||e.msRequestFullScreen;if(void 0!==t&&t)t.call(e);else if(void 0!==window.ActiveXObject){var n=new ActiveXObject("WScript.Shell");null!=n&&n.SendKeys("{F11}")}}()},c.set=function(){a.open({size:"md",templateUrl:"set.html",controller:["$scope","$uibModalInstance","$api",function(e,t,n){e.setInfo={title:r.Project[0].title,sector:r.Project[0].sector,account:r.Account._id,email:r.Account.email,phone:r.Account.mobile},e.OnSubmit=function(){e.setInfo.password===e.setInfo.pwd?n.project.update({id:r.Project[0]._id,title:e.setInfo.title},function(){n.account.update({uid:r.Account.uid,passwd:e.setInfo.password,email:e.setInfo.email,mobile:e.setInfo.phone},function(){c.showset=!1,t.dismiss})}):o.warning("两次密码输入不一致")},e.OnCancel=t.dismiss}]})},c.energytype=c.more[0].title,c.chooseenergytype=function(e){c.energytype=e.title},c.menuData.active=i.current.name,c.analyse="/analyse"==i.current.url||"/else{datatype}"==i.current.url,c.map="/buildingmap"==i.current.url,c.statistic="/statistic/:tab"==i.current.url,c.logout=function(){n.$logout({redirect:"/"}).then(function(){i.go("login")})},document.title="能耗分析系统-"+r.Project.current.title,c.title=r.Project.current.title+"能耗监测管理平台",r.type=c.type="usage",c.fulltype=function(){"usage"==c.type?r.type=c.type="cost":r.type=c.type="usage"},e.$on("$stateChangeSuccess",function(e,t,n,a,o){c.menuData.active=t.name,c.map="/buildingmap"==i.current.url,"/system"==i.current.url?(r.shownav=c.shownav=!1,c.dashboard=!0):"/chosen"==i.current.url?(r.shownav=c.shownav=!1,c.dashboard=!0):"/main"==i.current.url?(c.main=!0,r.shownav=c.shownav=!1,c.dashboard=!0):(c.main=!1,r.shownav=c.shownav=!0,c.dashboard=!1),c.analyse="/analyse"==i.current.url||"/else{datatype}"==i.current.url,c.statistic="/statistic/:tab"==i.current.url,!c.dashboard&&(l&&s.cancel(l)||l())})}]});